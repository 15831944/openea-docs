# 插件概述

**为解耦而生的插件**

OpenBPM 基于行业经验提供了高阶的业务抽象能力，利用策略模式、模板模式、适配器等预留可扩展点，力求让有扩展需求的功能都实现可插拔让系统灵活度达到极致。
除了解耦运用常见设计模式外，OpenBPM 还会有其他解耦方式，比如流程所有功能皆插件，可插拔，表单的控件组件，业务对象的持久化链、格式化链 等。

### 流程插件
AgileBPM 在 Activiti 事件基础上拓展了一套插件体系。
会在以下时机执行：
- 任务创建
- 任务完成
- 流程启动
- 流程结束

在插件中可以使用流程生命周期中的环境变量、如

- 表单业务数据
- 流程变量
- 流程实例
- 任务信息

```
流程插件会订阅事件，比如消息插件订阅了所有事件，即消息插件会在任务创建、任务结束、流程启动、流程结束均会执行（如果流程没有配置则不会执行）
```
- 流程插件
 - 节点消息插件
 - 节点表单初始化
 - 全局任务跳过插件
 - 节点自由跳转
 - 节点前后置脚本
 - 多实例分发
 - 流程催办
 - 流程插件变量

- 节点人员插件
 - 用户选择
 - 组选择（角色、岗位、组织）
 - 脚本
 - 用户关系

### 表单插件
自定义表单封装了很多组件比如：

- 自定义对话框组件
- 表单函数计算指令
- 数据字典组件
- 日期计算组件
- 日期校验比较组件
- 表单校验指令
- 权限指令
- 动态权限配置组件
- 动态联动下拉框组件
- 各种表单控件等

```
表单控件、组件在表单设计阶段，可以直接可视化配置，当然如果了解组件的实现和配置内容，也可以直接编辑源码的形式去配置组件
```

### 业务对象插件
业务对象在数据持久化和数据读取过程中定义了一个执行器链

**保存过程中的执行器链**

- 数据格式化处理，（前端是JSON形式格式化成 真正的数据格式）
- 业务数据权限处理 （只保存有编辑权限的字段并且后端校验必填字段）
- 乐观锁
- 逻辑删除
- 默认数据赋值插件

**获取数据的执行器链**

- 数据格式化
- 数据权限处理（只获取有只读以上的数据）
- 默认值赋值

```
业务对象的插件主要是在持久化和获取数据过程中处理加工业务数据
```
